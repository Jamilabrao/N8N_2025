{"updatedAt":"2025-12-03T17:25:24.135Z","createdAt":"2025-12-03T17:02:44.848Z","id":"8GeJu1UrldPjm1H6","name":"Generate Leads with Google Maps - AlexK1919","active":false,"isArchived":false,"nodes":[{"parameters":{},"id":"06dc40c9-a356-4830-b8c2-3a76e0812144","name":"When clicking \"Execute Workflow\"","type":"n8n-nodes-base.manualTrigger","position":[240,592],"typeVersion":1},{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":15}]}},"id":"7b16e7cc-dede-4847-ae4a-22a060acd17d","name":"Run workflow every hours","type":"n8n-nodes-base.scheduleTrigger","position":[240,352],"typeVersion":1.1,"disabled":true},{"parameters":{},"id":"9be75d82-130c-4c70-8fa9-dc89d797d3c6","name":"Execute Workflow Trigger","type":"n8n-nodes-base.executeWorkflowTrigger","position":[240,96],"typeVersion":1,"disabled":true},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"51e191cb-af20-423b-9303-8523caa4ae0d","operator":{"type":"number","operation":"gt"},"leftValue":"={{ $('Exponential Backoff').item.json[\"retryCount\"] }}","rightValue":10}]},"options":{}},"id":"366a30ca-3288-4ccf-9089-9ca38b1aa7ea","name":"Check Max Retries1","type":"n8n-nodes-base.if","position":[2992,640],"typeVersion":2.2},{"parameters":{"errorMessage":"Google Sheets API Limit has been triggered and the workflow has stopped"},"id":"ae071a4c-a72a-4ebb-a880-a779e4ca1279","name":"Stop and Error1","type":"n8n-nodes-base.stopAndError","position":[3200,640],"typeVersion":1},{"parameters":{"method":"POST","url":"https://places.googleapis.com/v1/places:searchText","authentication":"predefinedCredentialType","nodeCredentialType":"googleOAuth2Api","sendHeaders":true,"headerParameters":{"parameters":[{"name":"X-Goog-FieldMask","value":"places.id,places.displayName,places.addressComponents,places.formattedAddress,places.primaryType,places.primaryTypeDisplayName,places.types,places.location,places.nationalPhoneNumber,places.rating,places.userRatingCount,places.websiteUri,places.editorialSummary,places.reviews,places.attributions,places.userRatingCount"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"textQuery","value":"={{ $('Subcategory').item.json.Subcategory }} {{ $json.zip }}"}]},"options":{"response":{"response":{"fullResponse":true}}}},"id":"3b24f1f1-68e0-4c7b-a89b-4c9d88dbd20b","name":"GMaps API","type":"n8n-nodes-base.httpRequest","position":[1392,576],"typeVersion":4.2,"credentials":{"googleOAuth2Api":{"id":"9h0ciKxrLnLBqLql","name":"Google account"}}},{"parameters":{"operation":"update","documentId":{"__rl":true,"mode":"url","value":"={{ $('Settings').first().json.gs_url }}"},"sheetName":{"__rl":true,"mode":"name","value":"={{ $('Settings').first().json.sheet }}"},"columns":{"value":{"zip":"={{ $('Set Zip').first().json.zip }}","status":"scraped","subcat":"={{ $('Subcategory').first().json.Subcategory }}"},"schema":[{"id":"zip","type":"string","display":true,"removed":false,"required":false,"displayName":"zip","defaultMatch":false,"canBeUsedToMatch":true},{"id":"status","type":"string","display":true,"removed":false,"required":false,"displayName":"status","defaultMatch":false,"canBeUsedToMatch":true},{"id":"subcat","type":"string","display":true,"removed":false,"required":false,"displayName":"subcat","defaultMatch":false,"canBeUsedToMatch":true},{"id":"row_number","type":"string","display":true,"removed":false,"readOnly":true,"required":false,"displayName":"row_number","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["zip"]},"options":{}},"id":"71fd9014-0fbc-444c-bb56-697d63d0be32","name":"Update Status to Success","type":"n8n-nodes-base.googleSheets","position":[2832,1056],"executeOnce":true,"typeVersion":4.2,"alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"9W9MbbOmOV6F5Huv","name":"N8N - SHEET"}},"onError":"continueErrorOutput"},{"parameters":{"operation":"appendOrUpdate","documentId":{"__rl":true,"mode":"url","value":"={{ $('Settings').item.json.gs_url }}"},"sheetName":{"__rl":true,"mode":"name","value":"=Results"},"columns":{"value":{"type":"={{ $('Subcategory').item.json.Subcategory }}","phone":"={{ $json.place.nationalPhoneNumber }}","title":"={{ $json.place.displayName.text }}","types":"={{ $json.place.types }}","rating":"={{ $json.place.rating }}","address":"={{ $json.place.formattedAddress }}","reviews":"={{ $json.place.reviews }}","website":"={{ $json.place.websiteUri }}","place_id":"={{ $json.place.id }}","gps_coordinates":"={\"latitude\":{{ $json.place.location.latitude }},\"longitude\":{{ $json.place.location.longitude }}}"},"schema":[{"id":"ACTION","type":"string","display":true,"required":false,"displayName":"ACTION","defaultMatch":false,"canBeUsedToMatch":true},{"id":"STATUS","type":"string","display":true,"required":false,"displayName":"STATUS","defaultMatch":false,"canBeUsedToMatch":true},{"id":"title","type":"string","display":true,"required":false,"displayName":"title","defaultMatch":false,"canBeUsedToMatch":true},{"id":"email","type":"string","display":true,"required":false,"displayName":"email","defaultMatch":false,"canBeUsedToMatch":true},{"id":"name","type":"string","display":true,"required":false,"displayName":"name","defaultMatch":false,"canBeUsedToMatch":true},{"id":"firstname","type":"string","display":true,"required":false,"displayName":"firstname","defaultMatch":false,"canBeUsedToMatch":true},{"id":"lastname","type":"string","display":true,"required":false,"displayName":"lastname","defaultMatch":false,"canBeUsedToMatch":true},{"id":"phone","type":"string","display":true,"required":false,"displayName":"phone","defaultMatch":false,"canBeUsedToMatch":true},{"id":"clean url","type":"string","display":true,"required":false,"displayName":"clean url","defaultMatch":false,"canBeUsedToMatch":true},{"id":"website","type":"string","display":true,"required":false,"displayName":"website","defaultMatch":false,"canBeUsedToMatch":true},{"id":"WP API","type":"string","display":true,"required":false,"displayName":"WP API","defaultMatch":false,"canBeUsedToMatch":true},{"id":"WP","type":"string","display":true,"required":false,"displayName":"WP","defaultMatch":false,"canBeUsedToMatch":true},{"id":"facebook","type":"string","display":true,"required":false,"displayName":"facebook","defaultMatch":false,"canBeUsedToMatch":true},{"id":"instagram","type":"string","display":true,"required":false,"displayName":"instagram","defaultMatch":false,"canBeUsedToMatch":true},{"id":"youtube","type":"string","display":true,"required":false,"displayName":"youtube","defaultMatch":false,"canBeUsedToMatch":true},{"id":"tiktok","type":"string","display":true,"required":false,"displayName":"tiktok","defaultMatch":false,"canBeUsedToMatch":true},{"id":"twitter","type":"string","display":true,"required":false,"displayName":"twitter","defaultMatch":false,"canBeUsedToMatch":true},{"id":"linkedin","type":"string","display":true,"required":false,"displayName":"linkedin","defaultMatch":false,"canBeUsedToMatch":true},{"id":"pinterest","type":"string","display":true,"required":false,"displayName":"pinterest","defaultMatch":false,"canBeUsedToMatch":true},{"id":"reddit","type":"string","display":true,"required":false,"displayName":"reddit","defaultMatch":false,"canBeUsedToMatch":true},{"id":"rating","type":"string","display":true,"required":false,"displayName":"rating","defaultMatch":false,"canBeUsedToMatch":true},{"id":"reviews","type":"string","display":true,"required":false,"displayName":"reviews","defaultMatch":false,"canBeUsedToMatch":true},{"id":"type","type":"string","display":true,"required":false,"displayName":"type","defaultMatch":false,"canBeUsedToMatch":true},{"id":"address","type":"string","display":true,"required":false,"displayName":"address","defaultMatch":false,"canBeUsedToMatch":true},{"id":"price","type":"string","display":true,"required":false,"displayName":"price","defaultMatch":false,"canBeUsedToMatch":true},{"id":"place_id","type":"string","display":true,"removed":false,"required":false,"displayName":"place_id","defaultMatch":false,"canBeUsedToMatch":true},{"id":"position","type":"string","display":true,"required":false,"displayName":"position","defaultMatch":false,"canBeUsedToMatch":true},{"id":"data_id","type":"string","display":true,"required":false,"displayName":"data_id","defaultMatch":false,"canBeUsedToMatch":true},{"id":"data_cid","type":"string","display":true,"required":false,"displayName":"data_cid","defaultMatch":false,"canBeUsedToMatch":true},{"id":"reviews_link","type":"string","display":true,"required":false,"displayName":"reviews_link","defaultMatch":false,"canBeUsedToMatch":true},{"id":"photos_link","type":"string","display":true,"required":false,"displayName":"photos_link","defaultMatch":false,"canBeUsedToMatch":true},{"id":"gps_coordinates","type":"string","display":true,"required":false,"displayName":"gps_coordinates","defaultMatch":false,"canBeUsedToMatch":true},{"id":"place_id_search","type":"string","display":true,"required":false,"displayName":"place_id_search","defaultMatch":false,"canBeUsedToMatch":true},{"id":"provider_id","type":"string","display":true,"required":false,"displayName":"provider_id","defaultMatch":false,"canBeUsedToMatch":true},{"id":"types","type":"string","display":true,"required":false,"displayName":"types","defaultMatch":false,"canBeUsedToMatch":true},{"id":"open_state","type":"string","display":true,"required":false,"displayName":"open_state","defaultMatch":false,"canBeUsedToMatch":true},{"id":"hours","type":"string","display":true,"required":false,"displayName":"hours","defaultMatch":false,"canBeUsedToMatch":true},{"id":"operating_hours","type":"string","display":true,"required":false,"displayName":"operating_hours","defaultMatch":false,"canBeUsedToMatch":true},{"id":"description","type":"string","display":true,"required":false,"displayName":"description","defaultMatch":false,"canBeUsedToMatch":true},{"id":"service_options","type":"string","display":true,"required":false,"displayName":"service_options","defaultMatch":false,"canBeUsedToMatch":true},{"id":"order_online","type":"string","display":true,"required":false,"displayName":"order_online","defaultMatch":false,"canBeUsedToMatch":true},{"id":"thumbnail","type":"string","display":true,"required":false,"displayName":"thumbnail","defaultMatch":false,"canBeUsedToMatch":true},{"id":"editorial_reviews","type":"string","display":true,"required":false,"displayName":"editorial_reviews","defaultMatch":false,"canBeUsedToMatch":true},{"id":"unclaimed_listing","type":"string","display":true,"required":false,"displayName":"unclaimed_listing","defaultMatch":false,"canBeUsedToMatch":true},{"id":"reserve_a_table","type":"string","display":true,"required":false,"displayName":"reserve_a_table","defaultMatch":false,"canBeUsedToMatch":true},{"id":"user_review","type":"string","display":true,"required":false,"displayName":"user_review","defaultMatch":false,"canBeUsedToMatch":true},{"id":"amenities","type":"string","display":true,"required":false,"displayName":"amenities","defaultMatch":false,"canBeUsedToMatch":true},{"id":"book_online","type":"string","display":true,"required":false,"displayName":"book_online","defaultMatch":false,"canBeUsedToMatch":true}],"mappingMode":"defineBelow","matchingColumns":["place_id"]},"options":{}},"id":"f4dc9118-2255-46fe-ae62-fcf199691f5f","name":"Add rows in Google Sheets","type":"n8n-nodes-base.googleSheets","position":[2400,640],"typeVersion":4.2,"alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"9W9MbbOmOV6F5Huv","name":"N8N - SHEET"}},"onError":"continueErrorOutput"},{"parameters":{"assignments":{"assignments":[{"id":"4c5ad6be-28aa-455f-8ee2-edce1ab1bdbb","name":"row_number","type":"number","value":"={{ $json.row_number }}"}]},"includeOtherFields":true,"options":{}},"id":"333fb240-93b5-405c-89fe-ae457aaa7d7b","name":"Set Row Number","type":"n8n-nodes-base.set","position":[1392,-32],"typeVersion":3.4},{"parameters":{"assignments":{"assignments":[{"id":"7b1629c5-cbfe-4769-8286-66b46c51cd7e","name":"zip","type":"number","value":"={{ $('Loop Zips').first().json.zip }}"}]},"includeOtherFields":true,"options":{}},"id":"660c16d5-fdeb-4445-9120-9ac0a91cf3ca","name":"Set Zip","type":"n8n-nodes-base.set","position":[1200,576],"typeVersion":3.4},{"parameters":{"assignments":{"assignments":[{"id":"758ff896-7cd8-4f72-bfbb-e64583c5937c","name":"places.id","type":"string","value":"={{ $json.place.id }}"}]},"includeOtherFields":true,"options":{}},"id":"57917f14-91e4-47c2-b3bc-adbabf9aad95","name":"Set Place ID","type":"n8n-nodes-base.set","position":[2000,640],"typeVersion":3.4},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Define the retry count (coming from a previous node or set manually)\nconst retryCount = $json[\"retryCount\"] || 0;  // If not present, default to 0\nconst maxRetries = 5;  // Define the maximum number of retries\nconst initialDelay = 1;  // Initial delay in seconds (1 second)\n\n// If the retry count is less than the max retries, calculate the delay\nif (retryCount < maxRetries) {\n    const currentDelayInSeconds = initialDelay * Math.pow(2, retryCount);  // Exponential backoff delay in seconds\n    \n    // Log the delay time for debugging\n    console.log(`Waiting for ${currentDelayInSeconds} seconds before retry...`);\n    \n    return {\n        json: {\n            retryCount: retryCount + 1,  // Increment retry count\n            waitTimeInSeconds: currentDelayInSeconds, // Pass the delay time in seconds\n            status: 'retrying',\n        }\n    };\n} else {\n    // If max retries are exceeded, return a failure response\n    return {\n        json: {\n            error: 'Max retries exceeded',\n            retryCount: retryCount,\n            status: 'failed'\n        }\n    };\n}\n"},"id":"42ae464f-031d-4bb3-98b8-898576a8b6f9","name":"Exponential Backoff","type":"n8n-nodes-base.code","position":[2592,640],"typeVersion":2},{"parameters":{"compare":"selectedFields","fieldsToCompare":"place.id,places.id","options":{}},"id":"6c699e70-ce8d-4db5-81b4-54d90d582f05","name":"Remove Duplicates","type":"n8n-nodes-base.removeDuplicates","position":[2192,640],"typeVersion":1.1},{"parameters":{"amount":"={{ $json[\"waitTime\"] }}"},"id":"cd62b198-087c-4160-be09-c0fda83c8e0b","name":"Wait","type":"n8n-nodes-base.wait","position":[2800,640],"webhookId":"e0cf8da3-e4ab-490e-abcd-0c0c55b90846","typeVersion":1.1},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"51e191cb-af20-423b-9303-8523caa4ae0d","operator":{"type":"number","operation":"gt"},"leftValue":"={{ $('Exponential Backoff1').item.json[\"retryCount\"] }}","rightValue":10}]},"options":{}},"id":"17a24f54-40e4-41b0-b19e-e31a4b0e9798","name":"Check Max Retries","type":"n8n-nodes-base.if","position":[3440,1056],"typeVersion":2.2},{"parameters":{"errorMessage":"Google Sheets API Limit has been triggered and the workflow has stopped"},"id":"fca6f445-0a56-417e-b364-73ff7132e5db","name":"Stop and Error","type":"n8n-nodes-base.stopAndError","position":[3632,1056],"typeVersion":1},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Define the retry count (coming from a previous node or set manually)\nconst retryCount = $json[\"retryCount\"] || 0;  // If not present, default to 0\nconst maxRetries = 5;  // Define the maximum number of retries\nconst initialDelay = 1;  // Initial delay in seconds (1 second)\n\n// If the retry count is less than the max retries, calculate the delay\nif (retryCount < maxRetries) {\n    const currentDelayInSeconds = initialDelay * Math.pow(2, retryCount);  // Exponential backoff delay in seconds\n    \n    // Log the delay time for debugging\n    console.log(`Waiting for ${currentDelayInSeconds} seconds before retry...`);\n    \n    return {\n        json: {\n            retryCount: retryCount + 1,  // Increment retry count\n            waitTimeInSeconds: currentDelayInSeconds, // Pass the delay time in seconds\n            status: 'retrying',\n        }\n    };\n} else {\n    // If max retries are exceeded, return a failure response\n    return {\n        json: {\n            error: 'Max retries exceeded',\n            retryCount: retryCount,\n            status: 'failed'\n        }\n    };\n}\n"},"id":"40954f0e-857c-4b2d-80ae-432ed7cace1e","name":"Exponential Backoff1","type":"n8n-nodes-base.code","position":[3040,1056],"typeVersion":2},{"parameters":{"amount":"={{ $json[\"waitTime\"] }}"},"id":"7fd96695-dd55-4def-8c85-60649ebc8df5","name":"Wait1","type":"n8n-nodes-base.wait","position":[3232,1056],"webhookId":"670750d4-0c4d-4fff-b139-1d60be1eac68","typeVersion":1.1},{"parameters":{"assignments":{"assignments":[{"id":"fa469a25-eb00-4011-a626-87fae7fb8bbd","name":"gs_url","type":"string","value":"https://docs.google.com/spreadsheets/d/1COc_zCsir474oqe9kr6Zyd0dVMtOKtI4J9mt7YnPSm8/edit?gid=0#gid=0"},{"id":"df0a7a51-0ec6-47d2-9f73-bc8268385305","name":"catSheet","type":"string","value":"Google Maps Categories"},{"id":"a1ff9a58-9ae6-4000-9fcd-6c11de23bd48","name":"sheet","type":"string","value":"AZ Zips"}]},"options":{}},"id":"cdde3065-c49c-4d4b-9525-2f9ac59dd3cf","name":"Settings","type":"n8n-nodes-base.set","position":[512,256],"typeVersion":3.4},{"parameters":{"documentId":{"__rl":true,"mode":"url","value":"={{ $('Settings').item.json.gs_url }}"},"sheetName":{"__rl":true,"mode":"name","value":"={{ $('Settings').item.json.catSheet }}"},"options":{}},"id":"d2dae741-24d4-448c-9a7f-92b295d3f4b9","name":"GS - Get Subcategory","type":"n8n-nodes-base.googleSheets","position":[1088,240],"executeOnce":true,"typeVersion":4.2,"credentials":{"googleSheetsOAuth2Api":{"id":"9W9MbbOmOV6F5Huv","name":"N8N - SHEET"}}},{"parameters":{"assignments":{"assignments":[{"id":"d3470f6f-c66e-4223-bbf5-81e45201d45d","name":"Subcategory","type":"string","value":"={{ $json.Subcategory }}"}]},"includeOtherFields":true,"options":{}},"id":"e64c874d-858b-4fe1-860a-6312015063d2","name":"Subcategory","type":"n8n-nodes-base.set","position":[1488,240],"typeVersion":3.4},{"parameters":{"documentId":{"__rl":true,"mode":"url","value":"={{ $('Settings').item.json.gs_url }}"},"sheetName":{"__rl":true,"mode":"name","value":"={{ $('Settings').item.json.sheet }}"},"options":{}},"id":"f5cc5019-72e7-4086-8130-e4cd9efa3ee8","name":"GS - Get Zip Codes","type":"n8n-nodes-base.googleSheets","position":[800,-32],"executeOnce":true,"typeVersion":4.2,"credentials":{"googleSheetsOAuth2Api":{"id":"9W9MbbOmOV6F5Huv","name":"N8N - SHEET"}}},{"parameters":{"jsCode":"// Get the places array from the input data\nconst places = items[0]?.json?.body?.places || [];\n\n// Create an output array to hold each place as a separate item\nlet output = [];\n\nif (places.length > 0) {\n  for (let i = 0; i < places.length; i++) {\n    // For each place, push a new item into the output array\n    output.push({\n      json: {\n        place: places[i], // The individual place object\n        otherData: items[0].json.otherData || null  // Include other data or default to null\n      }\n    });\n  }\n} else {\n  // Log an error or handle the case where places array is empty or undefined\n  console.log('Places array is empty or undefined.');\n}\n\n// Return the output array, so each place becomes its own item\nreturn output;\n"},"id":"50d55dff-f737-4bfc-8b94-973c1f75a20a","name":"Place Array","type":"n8n-nodes-base.code","position":[1792,640],"typeVersion":2},{"parameters":{"options":{}},"id":"ee2665e1-2f46-432b-9fe1-3cd52549ea8f","name":"Loop Zips","type":"n8n-nodes-base.splitInBatches","position":[896,176],"typeVersion":3},{"parameters":{"options":{}},"id":"b1b2766a-6496-49a7-b7a3-3a40d748addf","name":"Loop Subcats","type":"n8n-nodes-base.splitInBatches","position":[992,512],"typeVersion":3},{"parameters":{"documentId":{"__rl":true,"mode":"url","value":"={{ $('Settings').first().json.gs_url }}"},"sheetName":{"__rl":true,"mode":"name","value":"={{ $('Settings').first().json.sheet }}"},"options":{}},"id":"c091a1a1-b8c5-43ca-a7b6-982c46f0f7ed","name":"GS - Get Status","type":"n8n-nodes-base.googleSheets","position":[2592,848],"executeOnce":true,"typeVersion":4.2,"credentials":{"googleSheetsOAuth2Api":{"id":"9W9MbbOmOV6F5Huv","name":"N8N - SHEET"}},"onError":"continueErrorOutput"},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"51e191cb-af20-423b-9303-8523caa4ae0d","operator":{"type":"number","operation":"gt"},"leftValue":"={{ $('Exponential Backoff2').item.json[\"retryCount\"] }}","rightValue":10}]},"options":{}},"id":"bd66eb11-49ca-42f4-9a96-6421a291e932","name":"Check Max Retries2","type":"n8n-nodes-base.if","position":[3200,848],"typeVersion":2.2},{"parameters":{"errorMessage":"Google Sheets API Limit has been triggered and the workflow has stopped"},"id":"d9f8f75b-2084-4be9-8ff8-f7bed2b09b5f","name":"Stop and Error2","type":"n8n-nodes-base.stopAndError","position":[3392,848],"typeVersion":1},{"parameters":{"mode":"runOnceForEachItem","jsCode":"// Define the retry count (coming from a previous node or set manually)\nconst retryCount = $json[\"retryCount\"] || 0;  // If not present, default to 0\nconst maxRetries = 5;  // Define the maximum number of retries\nconst initialDelay = 1;  // Initial delay in seconds (1 second)\n\n// If the retry count is less than the max retries, calculate the delay\nif (retryCount < maxRetries) {\n    const currentDelayInSeconds = initialDelay * Math.pow(2, retryCount);  // Exponential backoff delay in seconds\n    \n    // Log the delay time for debugging\n    console.log(`Waiting for ${currentDelayInSeconds} seconds before retry...`);\n    \n    return {\n        json: {\n            retryCount: retryCount + 1,  // Increment retry count\n            waitTimeInSeconds: currentDelayInSeconds, // Pass the delay time in seconds\n            status: 'retrying',\n        }\n    };\n} else {\n    // If max retries are exceeded, return a failure response\n    return {\n        json: {\n            error: 'Max retries exceeded',\n            retryCount: retryCount,\n            status: 'failed'\n        }\n    };\n}\n"},"id":"20d7e116-e919-49ab-ad76-1c079aac5763","name":"Exponential Backoff2","type":"n8n-nodes-base.code","position":[2800,848],"typeVersion":2},{"parameters":{"amount":"={{ $json[\"waitTime\"] }}"},"id":"0fe06c13-117f-4235-a279-f67fdcb09c2b","name":"Wait2","type":"n8n-nodes-base.wait","position":[2992,848],"webhookId":"d9b32a26-861f-46d5-a8d7-0ede2ea37fe6","typeVersion":1.1},{"parameters":{"maxItems":3},"id":"23d44b14-c0bc-4444-849c-b65afb552e05","name":"Limit","type":"n8n-nodes-base.limit","position":[1808,-32],"typeVersion":1},{"parameters":{"content":"# AlexK1919 \n![Alex Kim](https://media.licdn.com/dms/image/v2/D5603AQFOYMkqCPl6Sw/profile-displayphoto-shrink_400_400/profile-displayphoto-shrink_400_400/0/1718309808352?e=1736985600&v=beta&t=pQKm7lQfUU1ytuC2Gq1PRxNY-XmROFWbo-BjzUPxWOs)\n\n#### Iâ€™m Alex Kim, an AI-Native Workflow Automation Architect, Founder @ WotAI.\n\n\n### About Me\nhttps://wotai.co/community\n\n\n### Products Used \n[Google Maps API via Google Cloud Account](https://docs.n8n.io/integrations/builtin/credentials/google/oauth-generic/?utm_source=n8n_app&utm_medium=credential_settings&utm_campaign=create_new_credentials_modal)\n","height":1390,"width":250,"color":6},"id":"957ca488-f797-438c-8be5-f3f1b64f9916","name":"Sticky Note20","type":"n8n-nodes-base.stickyNote","position":[-112,-112],"typeVersion":1},{"parameters":{"content":"# Settings","height":1391,"width":247,"color":3},"id":"c736c240-0062-478d-bf49-e23e5489deec","name":"Sticky Note8","type":"n8n-nodes-base.stickyNote","position":[448,-112],"typeVersion":1},{"parameters":{"content":"In the Google Sheets document, set the subcategories you'd like to search for\n\nSet the URL of your Google Sheets document\n\nSet the Zip Code sheet name","height":220,"width":219,"color":7},"id":"e1edc086-bf8f-488d-b70d-00a7842efb3d","name":"Sticky Note15","type":"n8n-nodes-base.stickyNote","position":[448,-32],"typeVersion":1},{"parameters":{"content":"# Triggers","height":1391,"width":247,"color":7},"id":"742f9a75-a196-4a86-96ed-07c799cfac29","name":"Sticky Note","type":"n8n-nodes-base.stickyNote","position":[176,-112],"typeVersion":1},{"parameters":{"assignments":{"assignments":[{"id":"3d16d922-0ed3-4a0f-9707-43797438970d","name":"zip","type":"number","value":"={{ $json.zip }}"}]},"includeOtherFields":true,"options":{}},"id":"f3656f20-ec72-4f50-bcf1-406e4e87844f","name":"Zips","type":"n8n-nodes-base.set","position":[992,-32],"typeVersion":3.4},{"parameters":{"content":"# Google Maps API","height":880,"width":3060,"color":5},"id":"5a32d6ef-65d4-4566-bea0-35986878f4ac","name":"Sticky Note1","type":"n8n-nodes-base.stickyNote","position":[736,416],"typeVersion":1},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"9f5a5e37-faae-45db-8a22-ad7d5786ecfe","operator":{"type":"string","operation":"empty","singleValue":true},"leftValue":"={{ $json.status }}","rightValue":""}]},"options":{}},"id":"f0fc49eb-378c-4431-b84f-e872e8426130","name":"Filter Zips","type":"n8n-nodes-base.filter","position":[1200,-32],"typeVersion":2.2},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"b64333b6-67ce-47c4-a2cc-07303278d178","operator":{"type":"string","operation":"notEquals"},"leftValue":"={{ $json.STATUS }}","rightValue":"Ignore"}]},"options":{}},"id":"aa39018b-4289-4422-b53e-0a051f377a10","name":"Filter Subcategories","type":"n8n-nodes-base.filter","position":[1296,240],"typeVersion":2.2},{"parameters":{"conditions":{"options":{"version":2,"leftValue":"","caseSensitive":true,"typeValidation":"strict"},"combinator":"and","conditions":[{"id":"7424452f-e208-4e7e-8144-d0c6278bc0f0","operator":{"type":"object","operation":"empty","singleValue":true},"leftValue":"={{ $json.body }}","rightValue":""}]},"options":{}},"id":"1b6d3818-7059-4ef8-9016-b4ef6034f551","name":"If Empty","type":"n8n-nodes-base.if","position":[1600,576],"typeVersion":2.2},{"parameters":{"fieldToSplitOut":"row_number","include":"allOtherFields","options":{}},"id":"9fa95810-cac4-447c-bbb5-df14ae45de91","name":"Split Out","type":"n8n-nodes-base.splitOut","position":[1616,-32],"typeVersion":1},{"parameters":{"content":"# Data Prep","height":500,"width":3060,"color":4},"id":"73f8ec8a-493d-43e4-bd15-081f2da03d4c","name":"Sticky Note2","type":"n8n-nodes-base.stickyNote","position":[736,-112],"typeVersion":1}],"connections":{"Wait":{"main":[[{"node":"Check Max Retries1","type":"main","index":0}]]},"Zips":{"main":[[{"node":"Filter Zips","type":"main","index":0}]]},"Limit":{"main":[[{"node":"Loop Zips","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Check Max Retries","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"Check Max Retries2","type":"main","index":0}]]},"Set Zip":{"main":[[{"node":"GMaps API","type":"main","index":0}]]},"If Empty":{"main":[[{"node":"Loop Subcats","type":"main","index":0}],[{"node":"Place Array","type":"main","index":0}]]},"Settings":{"main":[[{"node":"GS - Get Zip Codes","type":"main","index":0}]]},"GMaps API":{"main":[[{"node":"If Empty","type":"main","index":0}]]},"Loop Zips":{"main":[[],[{"node":"GS - Get Subcategory","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Limit","type":"main","index":0}]]},"Filter Zips":{"main":[[{"node":"Set Row Number","type":"main","index":0}]]},"Place Array":{"main":[[{"node":"Set Place ID","type":"main","index":0}]]},"Subcategory":{"main":[[{"node":"Loop Subcats","type":"main","index":0}]]},"Loop Subcats":{"main":[[{"node":"Loop Zips","type":"main","index":0}],[{"node":"Set Zip","type":"main","index":0}]]},"Set Place ID":{"main":[[{"node":"Remove Duplicates","type":"main","index":0}]]},"Set Row Number":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"GS - Get Status":{"main":[[{"node":"Update Status to Success","type":"main","index":0}],[{"node":"Exponential Backoff2","type":"main","index":0}]]},"Check Max Retries":{"main":[[{"node":"Stop and Error","type":"main","index":0}],[{"node":"Update Status to Success","type":"main","index":0}]]},"Remove Duplicates":{"main":[[{"node":"Add rows in Google Sheets","type":"main","index":0}]]},"Check Max Retries1":{"main":[[{"node":"Stop and Error1","type":"main","index":0}],[{"node":"Add rows in Google Sheets","type":"main","index":0}]]},"Check Max Retries2":{"main":[[{"node":"Stop and Error2","type":"main","index":0}]]},"GS - Get Zip Codes":{"main":[[{"node":"Zips","type":"main","index":0}]]},"Exponential Backoff":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Exponential Backoff1":{"main":[[{"node":"Wait1","type":"main","index":0}]]},"Exponential Backoff2":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Filter Subcategories":{"main":[[{"node":"Subcategory","type":"main","index":0}]]},"GS - Get Subcategory":{"main":[[{"node":"Filter Subcategories","type":"main","index":0}]]},"Execute Workflow Trigger":{"main":[[{"node":"Settings","type":"main","index":0}]]},"Run workflow every hours":{"main":[[{"node":"Settings","type":"main","index":0}]]},"Update Status to Success":{"main":[[{"node":"Loop Subcats","type":"main","index":0}],[{"node":"Exponential Backoff1","type":"main","index":0}]]},"Add rows in Google Sheets":{"main":[[{"node":"GS - Get Status","type":"main","index":0}],[{"node":"Exponential Backoff","type":"main","index":0}]]},"When clicking \"Execute Workflow\"":{"main":[[{"node":"Settings","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"dcf156bf-fc55-41ff-be1b-7de6389b1067","activeVersionId":null,"triggerCount":0,"shared":[{"updatedAt":"2025-12-03T17:02:44.848Z","createdAt":"2025-12-03T17:02:44.848Z","role":"workflow:owner","workflowId":"8GeJu1UrldPjm1H6","projectId":"86fLtGJ4RKYxddia"}],"activeVersion":null,"tags":[]}