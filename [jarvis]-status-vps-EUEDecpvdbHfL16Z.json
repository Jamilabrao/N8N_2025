{"createdAt":"2025-04-11T16:54:07.674Z","updatedAt":"2025-05-24T15:24:28.679Z","id":"EUEDecpvdbHfL16Z","name":"[JARVIS] STATUS VPS","active":false,"nodes":[{"parameters":{"command":"echo \"CPU: $(top -bn1 | grep 'Cpu(s)' | sed 's/.*, *\\([0-9.]*\\)%* id.*/\\1/' | awk '{print 100 - $1\"%\"}'), MEMÓRIA: $(free -m | awk '/Mem:/ { printf(\"%.2f%\"), $3/$2 * 100 }'), HD: $(df -h / | awk 'NR==2 {print $5}')\""},"id":"7d3b454d-f2f3-4588-a5ee-955a22a151f3","name":"puxa os dados da vps","type":"n8n-nodes-base.ssh","typeVersion":1,"position":[80,360],"credentials":{"sshPassword":{"id":"A71BOj04jUcy5oMz","name":"SSH SERVIDOR TYPEBOT"}}},{"parameters":{"jsCode":"// Captura o valor de stdout do node anterior\nconst sshOutput = $json[\"stdout\"];\n\n// Extrair as porcentagens de CPU, Memória e HD usando regex\nconst cpuUsageMatch = sshOutput.match(/CPU: (\\d+(\\.\\d+)?)/);\nconst memoryUsageMatch = sshOutput.match(/MEMÓRIA: (\\d+(\\.\\d+)?)/);\nconst hdUsageMatch = sshOutput.match(/HD: (\\d+(\\.\\d+)?)/);\n\nif (cpuUsageMatch && memoryUsageMatch && hdUsageMatch) {\n    const cpu = parseFloat(cpuUsageMatch[1]);\n    const memoria = parseFloat(memoryUsageMatch[1]);\n    const hd = parseFloat(hdUsageMatch[1]);\n\n    // Retornar as porcentagens como um JSON com os itens separados\n    return {\n        cpu,\n        memoria,\n        hd\n    };\n} else {\n    throw new Error(\"Erro: Não foi possível extrair os valores de CPU, Memória e HD\");\n}"},"id":"7780c6f1-0360-4047-aaf6-37bab5f6eedd","name":"Code","type":"n8n-nodes-base.code","typeVersion":2,"position":[260,360]},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"loose","version":2},"conditions":[{"id":"7e75fe56-99c8-4e8a-a9b4-ddeb77017bb5","leftValue":"={{ $item(\"0\").$node[\"Code\"].json[\"cpu\"] }}","rightValue":80,"operator":{"type":"number","operation":"gte"}},{"id":"daacb5d3-2569-43e5-afc3-ab5a78e4980e","leftValue":"={{ $item(\"0\").$node[\"Code\"].json[\"memoria\"] }}","rightValue":80,"operator":{"type":"number","operation":"gte"}},{"id":"0b83b92e-1fee-455f-ba51-da4f8ac50ef7","leftValue":"={{ $item(\"0\").$node[\"Code\"].json[\"hd\"] }}","rightValue":80,"operator":{"type":"number","operation":"gte"}}],"combinator":"or"},"looseTypeValidation":true,"options":{}},"id":"2eb9fc01-cd11-44fb-adcb-d66101ecd48a","name":"If","type":"n8n-nodes-base.if","typeVersion":2.2,"position":[440,360]},{"parameters":{"method":"POST","url":"https://api.jstrafegoeautomacoes.com.br/message/sendText/jonespessoal","sendHeaders":true,"headerParameters":{"parameters":[{"name":"apikey","value":"8E7F89A88E23-4C74-984A-052D147FC57D"}]},"sendBody":true,"bodyParameters":{"parameters":[{"name":"number","value":"5551990178480"},{"name":"text","value":"=ALERTA VPS:\n\nCpu: {{ $json.cpu }}%\n\nMemória: {{ $json.memoria }}%\n\nHD: {{ $json.hd }}%"}]},"options":{"redirect":{"redirect":{}}}},"id":"10958ac2-8374-4b29-a9ce-bffd13dab98f","name":"evolution envia msg","type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[700,360],"disabled":true},{"parameters":{"content":"##  Monitorar o uso de CPU, memória e HD da VPS\n","height":280,"width":1100},"type":"n8n-nodes-base.stickyNote","position":[-140,260],"typeVersion":1,"id":"8ec7579d-1f43-409e-bfa8-f47d55dbefbc","name":"Sticky Note2"},{"parameters":{"content":"## Enviar MSG Evolutiom","height":240,"width":220,"color":5},"type":"n8n-nodes-base.stickyNote","position":[640,260],"typeVersion":1,"id":"8f740478-3b84-4341-9e00-fb560d3b1373","name":"Sticky Note3"},{"parameters":{"assignments":{"assignments":[{"id":"9e7c3348-0ebb-4765-b128-25edb58c1e41","name":"CPU","value":"={{ $json.cpu }}%","type":"string"},{"id":"cf09097c-280b-48f4-a3dc-c4fb632a6ede","name":"Memoria","value":"={{ $json.memoria }}%","type":"string"},{"id":"c95d119d-5c37-4626-add6-f9cc987d5d53","name":"HD","value":"={{ $json.hd }}%","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[640,100],"id":"deeb2f53-e17b-4c9e-9174-40222797ec51","name":"Edit Fields"},{"parameters":{"inputSource":"passthrough"},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-100,360],"id":"2545251f-29f3-489f-a53b-ca8d121e7e18","name":"When Executed by Another Workflow"}],"connections":{"puxa os dados da vps":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"If","type":"main","index":0}]]},"If":{"main":[[{"node":"Edit Fields","type":"main","index":0}],[{"node":"Edit Fields","type":"main","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"puxa os dados da vps","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"261683e3-27e3-4c88-8b76-930cb9aba87e","triggerCount":0,"tags":[]}